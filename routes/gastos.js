var gastos,    writeResponse = function (res, e, data) {        if (e) {            res.writeHead(500);            res.write(JSON.stringify(e));        } else {            res.writeHead(200);            console.log(data);            if (data) {                res.write(JSON.stringify(data));            }        }        res.end();    };exports.setDatabase = function (db) {    gastos = db.get('gastos');};exports.list = function (req, res) {    gastos.find({}, {}, function (err, docs) {        writeResponse(res, err, docs);    });};exports.get = function (req, res) {    gastos.find({_id: req.params.id}, {}, function (err, docs) {        writeResponse(res, err, docs && docs[0]);    });};exports.add = function (req, res) {    gastos.insert(req.body, function (err, doc) {        writeResponse(res, err, {id: doc._id});    });};exports.update = function (req, res) {    delete req.body._id; //Without removing _id, update fails    gastos.update({_id: req.params.id}, {$set: req.body}, function (err) {        writeResponse(res, err);    });};exports.remove = function (req, res) {    gastos.remove({_id: req.params.id}, function (err) {        writeResponse(res, err);    });};